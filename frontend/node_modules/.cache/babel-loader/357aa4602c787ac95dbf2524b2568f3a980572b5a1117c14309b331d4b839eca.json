{"ast":null,"code":"import { defineComponent, mergeModels, useModel, useTemplateRef, computed, readonly, provide, toRef, inject, onBeforeUnmount, openBlock, createElementBlock, Fragment, renderSlot, normalizeProps, guardReactiveProps, unref, createBlock, Transition, mergeProps, withCtx, withDirectives, resolveDynamicComponent, createCommentVNode, vShow } from \"vue\";\nimport { u as useDefaults } from \"./useDefaults-dJMhLizZ.mjs\";\nimport { u as useId } from \"./useId-BR0P33VS.mjs\";\nimport { c as collapseInjectionKey, g as globalCollapseStorageInjectionKey } from \"./keys-CsqIkltC.mjs\";\nimport { u as useShowHide } from \"./useShowHide-gK6_viwB.mjs\";\nconst _sfc_main = /* @__PURE__ */defineComponent({\n  ...{\n    inheritAttrs: false\n  },\n  __name: \"BCollapse\",\n  props: /* @__PURE__ */mergeModels({\n    horizontal: {\n      type: Boolean,\n      default: false\n    },\n    id: {\n      default: void 0\n    },\n    isNav: {\n      type: Boolean,\n      default: false\n    },\n    tag: {\n      default: \"div\"\n    },\n    initialAnimation: {\n      type: Boolean,\n      default: false\n    },\n    noAnimation: {\n      type: Boolean,\n      default: false\n    },\n    noFade: {\n      type: Boolean\n    },\n    lazy: {\n      type: Boolean,\n      default: false\n    },\n    unmountLazy: {\n      type: Boolean,\n      default: false\n    },\n    show: {\n      type: Boolean,\n      default: false\n    },\n    transProps: {},\n    visible: {\n      type: Boolean,\n      default: false\n    }\n  }, {\n    \"modelValue\": {\n      type: Boolean,\n      ...{\n        default: false\n      }\n    },\n    \"modelModifiers\": {}\n  }),\n  emits: /* @__PURE__ */mergeModels([\"hidden\", \"hide\", \"hide-prevented\", \"show\", \"show-prevented\", \"shown\", \"toggle\"], [\"update:modelValue\"]),\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    var _a;\n    const _props = __props;\n    const props = useDefaults(_props, \"BCollapse\");\n    const emit = __emit;\n    const modelValue = useModel(__props, \"modelValue\");\n    const computedId = useId(() => props.id, \"collapse\");\n    const element = useTemplateRef(\"element\");\n    let inCollapse = false;\n    const onEnter = el => {\n      inCollapse = true;\n      requestAnimationFrame(() => {\n        if (props.horizontal) {\n          el.style.width = `${el.scrollWidth}px`;\n        } else {\n          el.style.height = `${el.scrollHeight}px`;\n        }\n      });\n    };\n    const onBeforeLeave = el => {\n      if (inCollapse) {\n        return;\n      }\n      if (props.horizontal) {\n        el.style.width = `${el.scrollWidth}px`;\n      } else {\n        el.style.height = `${el.scrollHeight}px`;\n      }\n      el.offsetHeight;\n    };\n    const onLeave = el => {\n      requestAnimationFrame(() => {\n        if (props.horizontal) {\n          el.style.width = ``;\n        } else {\n          el.style.height = ``;\n        }\n      });\n    };\n    const onAfterEnter = el => {\n      el.style.height = ``;\n      el.style.width = ``;\n      inCollapse = false;\n    };\n    const onAfterLeave = el => {\n      el.style.height = ``;\n      el.style.width = ``;\n      inCollapse = false;\n    };\n    const {\n      showRef,\n      renderRef,\n      hide,\n      show,\n      toggle,\n      isActive,\n      computedNoAnimation,\n      contentShowing,\n      transitionProps\n    } = useShowHide(modelValue, props, emit, element, computedId, {\n      // addShowClass: false,\n      transitionProps: {\n        onBeforeLeave,\n        onEnter,\n        onLeave,\n        onAfterEnter,\n        onAfterLeave,\n        enterToClass: \"\",\n        leaveToClass: \"\",\n        enterFromClass: \"\",\n        leaveFromClass: \"\",\n        enterActiveClass: \"\",\n        leaveActiveClass: \"\"\n      }\n    });\n    const computedClasses = computed(() => ({\n      \"show\": isActive.value,\n      \"navbar-collapse\": props.isNav,\n      \"collapse-horizontal\": props.horizontal\n    }));\n    const sharedSlots = computed(() => ({\n      toggle,\n      show,\n      hide,\n      id: computedId.value,\n      visible: showRef.value\n    }));\n    __expose({\n      hide,\n      isNav: props.isNav,\n      show,\n      toggle,\n      visible: readonly(showRef)\n    });\n    provide(collapseInjectionKey, {\n      id: computedId,\n      hide,\n      show,\n      toggle,\n      visible: readonly(showRef),\n      isNav: toRef(() => props.isNav)\n    });\n    const appRegistry = (_a = inject(globalCollapseStorageInjectionKey, void 0)) == null ? void 0 : _a({\n      id: computedId.value,\n      toggle,\n      value: readonly(showRef)\n    });\n    onBeforeUnmount(() => {\n      appRegistry == null ? void 0 : appRegistry.unregister();\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(Fragment, null, [renderSlot(_ctx.$slots, \"header\", normalizeProps(guardReactiveProps(sharedSlots.value))), unref(renderRef) || unref(contentShowing) ? (openBlock(), createBlock(Transition, mergeProps({\n        key: 0\n      }, unref(transitionProps), {\n        \"enter-active-class\": unref(computedNoAnimation) ? \"\" : \"collapsing\",\n        \"leave-active-class\": unref(computedNoAnimation) ? \"\" : \"collapsing\",\n        appear: modelValue.value\n      }), {\n        default: withCtx(() => [withDirectives((openBlock(), createBlock(resolveDynamicComponent(unref(props).tag), mergeProps({\n          id: unref(computedId),\n          ref_key: \"element\",\n          ref: element,\n          class: [\"collapse\", computedClasses.value],\n          \"is-nav\": unref(props).isNav\n        }, _ctx.$attrs), {\n          default: withCtx(() => [unref(contentShowing) ? renderSlot(_ctx.$slots, \"default\", normalizeProps(mergeProps({\n            key: 0\n          }, sharedSlots.value))) : createCommentVNode(\"\", true)]),\n          _: 3\n        }, 16, [\"id\", \"class\", \"is-nav\"])), [[vShow, unref(showRef)]])]),\n        _: 3\n      }, 16, [\"enter-active-class\", \"leave-active-class\", \"appear\"])) : createCommentVNode(\"\", true), renderSlot(_ctx.$slots, \"footer\", normalizeProps(guardReactiveProps(sharedSlots.value)))], 64);\n    };\n  }\n});\nexport { _sfc_main as _ };","map":{"version":3,"names":["_props","__props","props","useDefaults","emit","__emit","modelValue","useModel","computedId","useId","id","element","useTemplateRef","inCollapse","onEnter","el","requestAnimationFrame","horizontal","style","width","scrollWidth","height","scrollHeight","onBeforeLeave","offsetHeight","onLeave","onAfterEnter","onAfterLeave","showRef","renderRef","hide","show","toggle","isActive","computedNoAnimation","contentShowing","transitionProps","useShowHide","enterToClass","leaveToClass","enterFromClass","leaveFromClass","enterActiveClass","leaveActiveClass","computedClasses","computed","value","isNav","sharedSlots","visible","__expose","readonly","provide","collapseInjectionKey","toRef","appRegistry","_a","inject","globalCollapseStorageInjectionKey","onBeforeUnmount","unregister"],"sources":["../src/components/BCollapse/BCollapse.vue"],"sourcesContent":["<template>\n  <slot name=\"header\" v-bind=\"sharedSlots\" />\n  <Transition\n    v-if=\"renderRef || contentShowing\"\n    v-bind=\"transitionProps\"\n    :enter-active-class=\"computedNoAnimation ? '' : 'collapsing'\"\n    :leave-active-class=\"computedNoAnimation ? '' : 'collapsing'\"\n    :appear=\"modelValue\"\n  >\n    <component\n      :is=\"props.tag\"\n      v-show=\"showRef\"\n      :id=\"computedId\"\n      ref=\"element\"\n      class=\"collapse\"\n      :class=\"computedClasses\"\n      :is-nav=\"props.isNav\"\n      v-bind=\"$attrs\"\n    >\n      <slot v-if=\"contentShowing\" v-bind=\"sharedSlots\" />\n    </component>\n  </Transition>\n  <slot name=\"footer\" v-bind=\"sharedSlots\" />\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  computed,\n  type EmitFn,\n  inject,\n  onBeforeUnmount,\n  provide,\n  readonly,\n  toRef,\n  useTemplateRef,\n} from 'vue'\nimport {useDefaults} from '../../composables/useDefaults'\nimport {useId} from '../../composables/useId'\nimport {collapseInjectionKey, globalCollapseStorageInjectionKey} from '../../utils/keys'\nimport type {BCollapseProps} from '../../types/ComponentProps'\nimport {BvTriggerableEvent} from '../../utils'\nimport {useShowHide} from '../../composables/useShowHide'\n\ndefineOptions({\n  inheritAttrs: false,\n})\n\nconst _props = withDefaults(defineProps<Omit<BCollapseProps, 'modelValue'>>(), {\n  horizontal: false,\n  id: undefined,\n  initialAnimation: false,\n  isNav: false,\n  lazy: false,\n  noAnimation: false,\n  unmountLazy: false,\n  tag: 'div',\n  show: false,\n  visible: false,\n})\n\nconst props = useDefaults(_props, 'BCollapse')\n\nconst emit = defineEmits<{\n  'hidden': [value: BvTriggerableEvent]\n  'hide': [value: BvTriggerableEvent]\n  'hide-prevented': [value: BvTriggerableEvent]\n  'show': [value: BvTriggerableEvent]\n  'show-prevented': [value: BvTriggerableEvent]\n  'shown': [value: BvTriggerableEvent]\n  'toggle': [value: BvTriggerableEvent]\n}>()\n\ntype SharedSlotsData = {\n  hide: () => void\n  id: string\n  show: () => void\n  toggle: () => void\n  visible: boolean\n}\n\ndefineSlots<{\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  default?: (props: SharedSlotsData) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  footer?: (props: SharedSlotsData) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  header?: (props: SharedSlotsData) => any\n}>()\n\nconst modelValue = defineModel<Exclude<BCollapseProps['modelValue'], undefined>>({\n  default: false,\n})\n\nconst computedId = useId(() => props.id, 'collapse')\n\nconst element = useTemplateRef<HTMLElement>('element')\n\nlet inCollapse = false\nconst onEnter = (el: Element) => {\n  inCollapse = true\n  requestAnimationFrame(() => {\n    if (props.horizontal) {\n      ;(el as HTMLElement).style.width = `${(el as HTMLElement).scrollWidth}px`\n    } else {\n      ;(el as HTMLElement).style.height = `${(el as HTMLElement).scrollHeight}px`\n    }\n  })\n}\nconst onBeforeLeave = (el: Element) => {\n  if (inCollapse) {\n    return\n  }\n  if (props.horizontal) {\n    ;(el as HTMLElement).style.width = `${el.scrollWidth}px`\n  } else {\n    ;(el as HTMLElement).style.height = `${el.scrollHeight}px`\n  }\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  ;(el as HTMLElement).offsetHeight // force reflow\n}\nconst onLeave = (el: Element) => {\n  requestAnimationFrame(() => {\n    if (props.horizontal) {\n      ;(el as HTMLElement).style.width = ``\n    } else {\n      ;(el as HTMLElement).style.height = ``\n    }\n  })\n}\n\nconst onAfterEnter = (el: Element) => {\n  ;(el as HTMLElement).style.height = ``\n  ;(el as HTMLElement).style.width = ``\n  inCollapse = false\n}\n\nconst onAfterLeave = (el: Element) => {\n  ;(el as HTMLElement).style.height = ``\n  ;(el as HTMLElement).style.width = ``\n  inCollapse = false\n}\n\nconst {\n  showRef,\n  renderRef,\n  hide,\n  show,\n  toggle,\n  isActive,\n  computedNoAnimation,\n  contentShowing,\n  transitionProps,\n} = useShowHide(modelValue, props, emit as EmitFn, element, computedId, {\n  // addShowClass: false,\n  transitionProps: {\n    onBeforeLeave,\n    onEnter,\n    onLeave,\n    onAfterEnter,\n    onAfterLeave,\n    enterToClass: '',\n    leaveToClass: '',\n    enterFromClass: '',\n    leaveFromClass: '',\n    enterActiveClass: '',\n    leaveActiveClass: '',\n  },\n})\n\nconst computedClasses = computed(() => ({\n  'show': isActive.value,\n  'navbar-collapse': props.isNav,\n  'collapse-horizontal': props.horizontal,\n}))\n\nconst sharedSlots = computed<SharedSlotsData>(() => ({\n  toggle,\n  show,\n  hide,\n  id: computedId.value,\n  visible: showRef.value,\n}))\n\ndefineExpose({\n  hide,\n  isNav: props.isNav,\n  show,\n  toggle,\n  visible: readonly(showRef),\n})\n\nprovide(collapseInjectionKey, {\n  id: computedId,\n  hide,\n  show,\n  toggle,\n  visible: readonly(showRef),\n  isNav: toRef(() => props.isNav),\n})\n\nconst appRegistry = inject(\n  globalCollapseStorageInjectionKey,\n  undefined\n)?.({\n  id: computedId.value,\n  toggle,\n  value: readonly(showRef),\n})\n\nonBeforeUnmount(() => {\n  appRegistry?.unregister()\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}